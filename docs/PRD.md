# PRD – MandalorMarket

> Generated by /kickoff

## Summary

- **MandalorMarket** est une boutique e‑commerce fictive inspirée de l’univers Star Wars, dédiée à la démonstration de compétences full‑stack (NestJS + Next.js).
- Le site propose un catalogue de produits thématiques (blasters, formations, crédits galactiques, etc.) avec parcours client complet : découverte, recherche, filtres, panier et commande simulée.
- Des rôles structurés (**client**, **vendeur**, **admin**) permettent de couvrir des cas d’usage réels : marketplace multi‑vendeurs, gestion de produits, commandes et avis.
- L’architecture repose sur un **monorepo** moderne (NestJS API + Next.js App Router, TypeScript, Tailwind + shadcn/ui, Supabase + Prisma) déployé sur Vercel avec base Supabase managée.
- L’interface offre un **design dark sobre**, aux accents “beskar” (or/jaune), lisible et pro, avec une touche Star Wars sans gêner la compréhension e‑commerce classique.

## Target users

- **Persona principal – Recruteur / Engineering Manager**  
  Veut rapidement évaluer la capacité du développeur à concevoir et livrer une application web e‑commerce complète, bien structurée, maintenable et agréable à utiliser.

- **Persona secondaire – Utilisateurs finaux du site (clients & vendeurs)**  
  Clients : veulent parcourir facilement le catalogue, trouver des produits adaptés et passer commande sans friction.  
  Vendeurs : veulent un dashboard simple mais riche pour publier leurs produits, suivre leurs ventes et piloter leurs expéditions.

## User journeys

1. **Parcours client (invité ou connecté) – Achat & avis**
   1. Arrive sur la **homepage** et découvre : produits recommandés, collections, promotions, dernières recherches (si connecté).
   2. Utilise la **barre de recherche** et/ou les **filtres** (type de produit, prix, origine, taille, popularité, etc.) pour affiner le catalogue.
   3. Ouvre une **fiche produit** (image, description, type, prix en crédits galactiques, stock, avis, note moyenne).
   4. Ajoute le produit au **panier**, poursuit ses achats ou passe au **checkout**.
   5. Au checkout, saisit les **informations légales nécessaires** pour un bon de commande/facture (identité, adresse, coordonnées), choisit les options de livraison, confirme la commande (paiement simulé).
   6. Consulte la **page de confirmation** et, une fois la commande marquée livrée, peut laisser un **avis (1–5 étoiles, commentaire facultatif)**, limité à un avis par produit acheté, modifiable/supprimable par lui-même.

2. **Parcours vendeur – De la demande de compte au suivi de ventes**
   1. Le futur vendeur s’inscrit via un **formulaire dédié vendeur** (auth Supabase), créant un compte utilisateur classique avec une **demande de rôle vendeur**.
   2. En attendant validation, il a un compte **client standard**.
   3. Une fois validé par un **admin**, il accède à son **dashboard vendeur** sécurisé.
   4. Depuis ce dashboard, il **crée et gère ses produits** (type, nom, description, images, prix en crédits, stock, origine, marque, taille, promotion, etc.).
   5. Il suit ses **commandes** (uniquement celles de ses produits), met à jour les **statuts d’expédition**, voit ses **statistiques** (CA en crédits, #commandes, panier moyen, top produits, commandes en attente, courbe 7/30 jours, taux d’annulation, taux d’avis positifs/négatifs).

3. **Parcours admin – Maîtrise du site**
   1. L’admin se connecte via l’auth Supabase et accède à un **dashboard admin** global.
   2. Il consulte et traite la **liste des demandes de comptes vendeurs** (validation/refus), peut promouvoir/déclasser des utilisateurs (rôles admin/vendeur/client).
   3. Il supervise toutes les **commandes** (quel que soit le vendeur), peut ajuster les statuts (pending, paid, shipped, cancelled) et résoudre les cas particuliers.
   4. Il gère le **catalogue global** (créer/éditer/supprimer des produits, modifier les promotions, mettre en avant certains articles/collections).
   5. Il **modère les avis** (suppression, édition au besoin), surveille les métriques globales (CA, commandes, performances vendeurs) et assure la cohérence de l’expérience.

4. **Parcours “Mon compte” – Client connecté**
   1. L’utilisateur se connecte et accède à la section **“Mon compte”** depuis la navbar.
   2. Il consulte son **historique de commandes**, le détail de chaque commande, son statut et ses factures/bons de commande.
   3. Il gère ses **informations personnelles** (coordonnées, adresses) et voit les produits pour lesquels il peut laisser ou modifier un **avis**.

5. **Parcours recruteur – Découverte & évaluation**
   1. Le recruteur visite MandalorMarket, parcourt la homepage, le catalogue et les fiches produit pour juger l’UX/UI.
   2. Il joue les scénarios client, vendeur et admin (avec comptes pré-configurés) pour vérifier la cohérence des flows et des rôles.
   3. Il consulte la **documentation** (README, PRD, schémas d’architecture) et, éventuellement, le code du monorepo pour évaluer la qualité technique.

## Features

### Must

- **Architecture & stack**
  - Monorepo `pnpm` avec front (`Next.js` App Router + TypeScript + Tailwind CSS + shadcn/ui + icônes Lucide) et back (`NestJS` + TypeScript).
  - Base de données managée **Supabase (PostgreSQL)**, intégrée via **Prisma** côté backend.
  - Déploiement sur **Vercel** (front) + configuration adaptée pour l’API Nest (Vercel ou autre cible compatible, précisée plus tard).
  - Script racine `pnpm dev` lançant `pnpm front` et `pnpm back`.

- **Auth & rôles**
  - Authentification gérée par **Supabase Auth** (email + mot de passe), pas de gestion manuelle de JWT dans le code applicatif.
  - Rôles utilisateurs : **client**, **vendeur**, **admin**, stockés et exploités de manière centralisée (association utilisateur ↔ rôle(s)).
  - **Deux parcours d’inscription** distincts : inscription client simple, inscription vendeur avec création d’une demande de validation par admin.
  - Gestion fine des accès : seuls les vendeurs/admins accèdent aux dashboards vendeurs/admins, les autres voient uniquement l’interface client.

- **Catalogue & produits**
  - Modèle de produit incluant au minimum : type (blaster, formation, crédit, etc.), nom, description, prix en **crédits galactiques** (1 crédit = 1 €), stock, images, origine (pays de fabrication), marque, taille/grandeur, indicateurs (promotion, produit mis en avant, popularité).
  - Pages **liste produits** (catalogue) avec **recherche** (nom/description) et **filtres** (type, prix, origine, taille, disponibilité, popularité…).
  - **Tri façon Shopify** : par prix (croissant/décroissant), nouveauté/ancienneté, popularité, etc.
  - Pages **collections** (liste des collections + template par collection) avec mise en avant visuelle et texte de description.

- **Homepage**
  - Hero/intro mettant en avant MandalorMarket, avec rappel de l’univers Star Wars sans excès.
  - Sections : **produits recommandés**, **collections**, **promotions en cours**, et **dernières recherches** pour l’utilisateur connecté.
  - Navigation claire vers les catégories principales (Blasters, Formations, Crédits, Promos, Collections, etc.).

- **Panier & commande (paiement simulé)**
  - Gestion de **panier** (ajout, retrait, modification des quantités).
  - **Checkout** accessible aux invités et aux utilisateurs connectés.
  - Collecte des **informations nécessaires légalement** pour un bon de commande/facture (identité, adresse postale complète, email, éventuellement coordonnées supplémentaires).
  - Statuts de commande au minimum : `pending`, `paid` (simulé), `shipped`, `cancelled`.
  - Page de **confirmation de commande** et vue historique dans “Mon compte”.

- **Dashboards**
  - **Dashboard vendeur** avec :
    - Liste et gestion de **ses produits** (CRUD, gestion du stock, promotions, mise en avant).
    - Liste de **ses commandes**, avec mise à jour du statut d’expédition.
    - **Tableau de bord chiffré** : CA en crédits, nombre de commandes, panier moyen, top produits, commandes en attente d’expédition, courbe d’activité (7/30 jours), taux d’annulation, taux d’avis positifs/négatifs.
  - **Dashboard admin** avec :
    - Liste et gestion des **demandes de comptes vendeurs** (validation/refus).
    - Vue globale des **commandes** (tous vendeurs), avec possibilité d’ajuster les statuts.
    - Gestion complète du **catalogue** (CRUD global sur les produits).
    - Gestion des **utilisateurs et rôles** (promotion/déclassement admin/vendeur/client).
    - Modération des **avis produits**.

- **Avis & commentaires**
  - Système d’**avis produits** :
    - Une **note de 1 à 5 étoiles**.
    - Un **commentaire texte facultatif**.
    - Limité à **un avis par utilisateur et par produit**, uniquement pour les utilisateurs ayant réellement commandé le produit.
  - Le client peut **créer, éditer et supprimer** son propre avis.
  - Le vendeur peut **consulter** les avis sur ses produits, sans pouvoir les modifier ni les masquer.
  - L’admin peut tout faire (modération complète).

- **UI/UX**
  - Site en **français**, responsive (desktop first, mobile secondaire mais soigné).
  - Design **dark mode par défaut**, palette sombre avec accents **or/jaune “beskar”**, quelques touches de couleurs inspirées Star Wars mais non dominantes.
  - Layout propre façon e‑commerce moderne : navbar claire (logo, recherche, catégories avec sous-menus, compte, panier, promos), cartes produits lisibles (image, titre, type, prix, note, CTA).
  - Quelques **effets “wahou” subtils** : hovers sur cartes, transitions fluides, petites animations non intrusives.

- **Pages supplémentaires**
  - Page **“Mon compte”** (profil, adresses, commandes, avis).
  - Page **Contact** simple (formulaire ou informations de contact).

### Should

- **Accessibilité & SEO de base**
  - Contrastes corrects, tailles de police raisonnables, structure sémantique minimale (titres, balises).
  - Meta tags essentiels (titre, description) et URLs lisibles pour les principales pages (home, catégories, produits, collections).

- **Performances & UX**
  - Pagination ou lazy loading sur les listes de produits.
  - Skeleton loaders/spinners pour les chargements sensibles (catalogue, dashboards).
  - Messages de feedback clairs (toasts, erreurs de formulaire, confirmations).

- **Ergonomie vendeurs/admin**
  - Filtres et recherches dans les dashboards (par statut de commande, par produit, par vendeur).
  - Export CSV simple de certaines données (par exemple commandes d’un vendeur) si le temps le permet.

### Could

- Intégration d’un **vrai provider de paiement** (Stripe en mode test) pour des démos avancées.
- **Notifications temps réel** (WebSocket/SSR) pour les nouvelles commandes ou changements de statut.
- Système de **coupons/promo codes**, gestion des retours/remboursements.
- **Multi-langue** (français/anglais) et options de localisation avancées.
- Recommandations de produits plus intelligentes (basées sur l’historique ou des règles plus élaborées).

## Non-goals

- Mise en conformité juridique complète (CGV/CGU, politique de confidentialité, mentions légales détaillées) au-delà d’une simple page de contact.
- Gestion avancée des **retours/remboursements**, litiges complexes, et comptabilité réelle.
- **Chat temps réel** entre clients et vendeurs, support intégré, système de tickets.
- Programme de fidélité complexe, coupons de réduction sophistiqués, points de fidélité, etc.
- Optimisation SEO poussée (blog, maillage interne avancé, rich snippets), et accessibilité “AA/AAA” formelle.

## Success metrics

- **North star metric**  
  - Un recruteur ou pair technique peut, en **moins de 5 minutes de démo**, comprendre la proposition de valeur de MandalorMarket et juger l’application comme **propre, cohérente et de niveau “projet réel”**.

- **Supporting metrics**
  - Les **trois parcours principaux** (client, vendeur, admin) peuvent être exécutés **de bout en bout sans bug bloquant** lors d’une démo.
  - Lors d’une **review de code et de documentation**, l’architecture (Nest/Next/Prisma/Supabase), la structure du monorepo et les choix techniques sont jugés **clairs, justifiés et maintenables**.

## Constraints

- **Budget**: 0 € (projet personnel de démonstration).
- **Temps**: pas de deadline externe stricte, mais objectif personnel de disposer d’un **POC présentable le plus vite possible**.
- **Plateforme & stack technique**
  - Monorepo `pnpm` avec `NestJS` pour l’API et `Next.js` App Router pour le front.
  - **TypeScript** partout, **Tailwind CSS** + **shadcn/ui** + icônes Lucide pour l’UI.
  - **Supabase** pour la base de données PostgreSQL managée et l’authentification.
  - **Prisma** comme ORM principal côté backend (connecté à la base Supabase).
  - Déploiement sur **Vercel** (au minimum pour le front, avec stratégie adaptée pour le back).
- **Sécurité**
  - Délégation de l’authentification à **Supabase Auth** (gestion des sessions et tokens côté Supabase).
  - Utilisation de pratiques de base (variables d’environnement, séparation des clés publiques/privées, etc.).
- **Légal**
  - Données clients limitées au strict nécessaire pour un bon de commande/facture dans un contexte de démo.
  - Pas de traitements RGPD avancés pour ce POC, ni de mécanismes complexes d’opt‑in marketing.

## Risks & unknowns

- **Complexité d’intégration Supabase Auth** avec un backend NestJS et un frontend Next.js, notamment pour propager les rôles et sécuriser les API (vérification des sessions côté serveur).
  - Décision d’architecture à clarifier : quelles routes passent directement par Supabase (front) et lesquelles par l’API Nest protégée ?
- **Scope fonctionnel riche pour un POC** (plusieurs rôles, dashboards chiffrés, avis, filtres avancés) pouvant rallonger nettement le temps de mise en œuvre.
- **Design & UX**: trouver le bon équilibre entre esthétique Star Wars et sobriété pro; risque de passer trop de temps sur le polishing visuel.
- **Évolutivité**: si le POC est étendu (plus de produits, plus de vendeurs), certains choix initiaux (index, pagination, agrégations statistiques) devront être ajustés.
- **Aspects légaux & IP** si le projet devient plus public (usage de noms/images trop proches de la marque Star Wars).

## Open questions

- Comment organiser précisément la séparation des **rôles et autorisations** entre Supabase (claims/metadata) et l’API Nest (guards, décorateurs, middleware) ?
- Jusqu’où pousser la **précision des statistiques** dans les dashboards (temps réel vs agrégations calculées périodiquement) pour rester dans un effort “POC” raisonnable ?
- Quel niveau de **gestion des erreurs et d’observabilité** (logs, monitoring, traces) est souhaité pour la démo (simple console/logs, ou intégration d’un outil type Sentry) ?
- Faut‑il prévoir dès maintenant un **mode démo** avec jeux de données et comptes pré-configurés (client, vendeur, admin) facilement réinitialisables ?
- À quel moment envisager une **intégration de paiement réelle** (Stripe test) si le POC est jugé concluant et doit évoluer vers une démo plus avancée ?